## 자료구조 구조체와 포인터

안녕하세요. 둥둥입니다! 오늘은 구조체와 포인터 간의 상관관계를 한번 배워보도록 할거예요! (어려운 거 + 어려운 거 = 더 어려운 거)

### 변수를 동적으로 생성하는 법

예전 시간에 우리는 포인터를 통해 변수를 동적으로 생성하는 방법에 대해 알아봤었어요, int *pN = malloc(sizeof(int)); 이런식으로 말이죠, 이렇게 하면 무슨일이 일어나느냐?

- sizeof(int) : 해당 컴파일러가 취급하는 int 자료형의 사이즈를 계산해줍니다. 우리는 4바이트라고 계산 하겠습니다.
- malloc(x) : x 바이트 수 만큼 메모리를 할당하고 해당 메모리의 주소값을 얻어옵니다.
- int *nP : nP라는 이름을 가졌고, int 자료형의 사이즈 만큼의 메모리를 담을 수 있는 포인터 형태의 변수를 생성합니다.

즉, 4 바이트의 메모리를 생성하고 그 주소를 nP에 담는겁니다.

### 변수를 동적으로 생성하는 일이 왜 필요한가요?

지난 강의를 제대로 보신분들이라면, 이미 알고 계시겠지만! 한 번 더 설명드릴게요~!

만약 어떤 고객사가 학생 성적 관리 프로그램을 만들어달라고했을 때, 우리는 각 학생들의 성적을 담을 변수를 먼저 만들어야할거예요. 그럼 이 때 배열을 이용해서 변수를 만든다고치면, int students[100] 과 같은 형태로 만들어야겠죠?

그런데 여기서 가장 큰 문제가 있습니다.

##### 학생수가 100명보다 적을수도있고, 많을수도있다.

우리가 만약 위 처럼 만들었는데, 실제 학생수가 10명남짓이라면? (4 x 90)바이트의 메모리를 항상 낭비하게 되는겁니다! 또 만약, 학생 수가 점점 늘어나 101명이 된다면? 우리 프로그램은 접근 index over로 죽게 될겁니다ㅠㅠ

그래서, 동적 할당을 이용해서 학생이 추가로 필요할때마다 메모리를 새로 생성하는 방법을 선택하곤합니다. int *pN = malloc(sizeof(int)); 이와 같은 형태로 말이죠.

### 구조체를 포인터로 

놀라운 소식이 있어요! 구조체 또한 포인터를 이용해 동적할당할 수 있습니다. 전 시간에 만들었던 주소록을 동적할당으로 만들어보겠습니다. 구조체 포인터의 경우엔 쩜(.)이 아니라 방향(->)을 이용해 접근한답니다! 

```
#include <stdio.h>
#include <string.h>    // strcpy 함수가 선언된 헤더 파일

struct PhoneBookItem {   
    char name[20];   
    char phone[20];  // 010-0000-0000 (15자리, 넉넉히 20 자리까지)
};
int main()
{
    // 구조체 변수 선언
    struct PhoneBookItem* p1 = malloc(sizeof(struct PhoneBookItem));
    
    // -> 으로 구조체 멤버에 접근하여 값 할당
    strcpy(p1->name, "홍길동");
    strcpy(p1->phone, "010-0000-0000");

    // -> 으로 구조체 멤버에 있는 값 출력
    printf("이름: %s\n", p1->name);       
    printf("전화번호: %s\n", p1->phone);    

    return 0;
}
```
